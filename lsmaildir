#!/bin/bash

##########################################################################################
#Данный сценарий преобразует имена русскоязычных директорий MAILDIR, в человекочитаемые,
#выводя сравнительную таблицу нормальных имён файлов и оригинальных.
##########################################################################################

#Создаём функцию преобразования.
lsmaildir() {

#Создаём временный файл и заносим в переменную lsofcurrentdir путь к этому файлу.
lsofcurrentdir=$(mktemp)

#Заносим во временный файл листинг директории.
ls -1 "$@" > $lsofcurrentdir

#Преобразуем листинг директории в человекочитаемый вид. Выстраиваем таблицу соотвествия оригинальных имён файлов и конвертированных.
ls -1 "$@" | sed -e 's:&:+:g' -e 's:,:/:g' -e 's:++:+-+:g' | iconv -f UTF7 -t UTF8 | paste - $lsofcurrentdir | column -s $'\t' -t

#Удаляем созданный временный файл.
rm -f $lsofcurrentdir

}

#Если в качестве аргумента к скрипту указано -h или --help - вывести справку. Если что-либо другое, или аргумента нет вообще - выполнять функцию lsmaildir.
case "$@" in
        -h | --help)printf "Данный сценарий преобразует русскоязычные директории MAILDIR, в текущей директории, в человекочитаемые, \
выводя сравнительную таблицу нормальных имён файлов и оригинальных.\n";;
        *) lsmaildir "$@";;
        esac
